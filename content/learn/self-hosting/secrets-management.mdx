---
title: সিক্রেটস ম্যানেজমেন্ট
icon: ph:key-duotone
---

সিক্রেট মানে—পাসওয়ার্ড, API key, টোকেন, এনক্রিপশন কী, ডাটাবেস ইউআরএল—যা লিক হলে ডাটা/অ্যাপ/ইনফ্রা ঝুঁকিতে পড়বে। এই অধ্যায়ে .env, Vault, SOPS, Kubernetes Secrets—সবকিছু সহজ ভাষায়, উদাহরণসহ ব্যাখ্যা করা হয়েছে।

## কেন সিক্রেট ম্যানেজমেন্ট দরকার?
- গিটে সিক্রেট গেলে ডাটা লিক
- একাধিক এনভায়রনমেন্টে (dev/prod) আলাদা সিক্রেট
- রোটেশন, এক্সপায়ারি, অডিট
- অ্যাক্সেস কন্ট্রোল

## তুলনা
| পদ্ধতি | সহজ | স্কেল | নিরাপত্তা |
|--------|------|------|------------|
| .env ফাইল | হ্যাঁ | ছোট | মাঝারি (ফাইল পারমিশন)
| Vault | না | বড় | খুব বেশি (ACL, অডিট)
| SOPS | হ্যাঁ | মিড | এনক্রিপ্টেড গিট |
| K8s Secrets | না | বড় | বেসিক (base64), RBAC |
| AWS Secrets Manager | না | বড় | খুব বেশি (IAM, অটো-রোটেশন) |
| Google Secret Manager | না | বড় | খুব বেশি (IAM, অডিট লগ) |

## .env ফাইল (সিম্পল)
```bash
cat > .env <<'EOF'
DB_URL=postgres://user:pass@db/app
JWT_SECRET=$(openssl rand -hex 32)
EOF
chmod 600 .env
```
Compose-এ ব্যবহার:
```yaml
services:
	app:
		env_file: .env
```
**গিটে .env রাখবেন না!** `.gitignore`-এ যোগ করুন:
```
.env
```

পাইথন অ্যাপে লোড করা:
```python
from dotenv import load_dotenv
load_dotenv()  # .env থেকে ENV ভ্যারিয়েবল লোড করে
import os
db_url = os.getenv('DB_URL')
```

## Vault (HashiCorp)
Vault দিয়ে সিক্রেট সেন্ট্রালাইজ, অডিট, রোটেট, অ্যাক্সেস কন্ট্রোল করা যায়।
```bash
docker run -d --name vault -e 'VAULT_DEV_ROOT_TOKEN_ID=root' -p 8200:8200 vault
export VAULT_ADDR='http://127.0.0.1:8200'
vault login root
vault kv put secret/myapp DB_URL=postgres://user:pass@db/app JWT_SECRET=xyz
vault kv get secret/myapp
```
CI/CD-তে: Vault থেকে টোকেন/সিক্রেট ফেচ করে ENV-এ সেট করুন।

GitHub Actions-এ Vault ইন্টিগ্রেশন উদাহরণ:
```yaml
jobs:
  build:
    steps:
      - name: Fetch Secrets from Vault
        uses: hashicorp/actions/vault-action@v2
        with:
          url: ${{ secrets.VAULT_ADDR }}
          token: ${{ secrets.VAULT_TOKEN }}
          secrets: |
            secret/myapp/DB_URL | DB_URL ;
            secret/myapp/JWT_SECRET | JWT_SECRET
      - run: echo $DB_URL  # এখানে ব্যবহার করুন
```

## SOPS (YAML/JSON এনক্রিপ্টেড গিট)
SOPS দিয়ে YAML/JSON/TOML ফাইল এনক্রিপ্ট করে গিটে রাখা যায়।
```bash
cat > secrets.yaml <<EOF
db_url: postgres://user:pass@db/app
jwt_secret: xyz
EOF
sops -e -i secrets.yaml
```
ডিক্রিপ্ট:
```bash
sops -d secrets.yaml
```
GPG, KMS, বা age দিয়ে কী ম্যানেজ করুন।

Kubernetes-এ SOPS ইন্টিগ্রেশন: Flux বা ArgoCD-এ SOPS প্লাগিন ব্যবহার করে ডিক্রিপ্ট করে অ্যাপ্লাই করুন।

## Kubernetes Secrets
```yaml
apiVersion: v1
kind: Secret
metadata:
	name: mysecret
type: Opaque
data:
	db_url: cG9zdGdyZXM6Ly91c2VyOnBhc3NAZGIvYXBw
	jwt_secret: eHl6
```
base64 encode করে YAML-এ দিন। RBAC দিয়ে অ্যাক্সেস কন্ট্রোল করুন।

পডে মাউন্ট করা:
```yaml
apiVersion: v1
kind: Pod
metadata:
  name: mypod
spec:
  containers:
  - name: mycontainer
    image: myimage
    volumeMounts:
    - name: secret-volume
      mountPath: /secrets
  volumes:
  - name: secret-volume
    secret:
      secretName: mysecret
```

## ক্লাউড-ভিত্তিক সিক্রেট ম্যানেজার (AWS, Google)
### AWS Secrets Manager
AWS-এ সিক্রেট স্টোর, অটো-রোটেশন, IAM পলিসি দিয়ে অ্যাক্সেস কন্ট্রোল।
```bash
aws secretsmanager create-secret --name mysecret --secret-string '{"DB_URL":"postgres://user:pass@db/app"}'
aws secretsmanager get-secret-value --secret-id mysecret
```
Lambda-এ রোটেশন ফাংশন সেট করুন। ECS/EC2-এ IAM রোল দিয়ে ফেচ করুন।

### Google Secret Manager
GCP-এ সিক্রেট ম্যানেজ, অডিট লগ, ভার্সনিং।
```bash
gcloud secrets create mysecret --data-file=secrets.txt
gcloud secrets versions access latest --secret=mysecret
```
Cloud Run বা GKE-এ সিক্রেট মাউন্ট করুন।

## ডায়াগ্রাম (সিক্রেট ফ্লো)
```
┌────────────┐   ┌────────────┐   ┌────────────┐   ┌────────────┐
│ Developer  │→  │  Secrets   │→  │  CI/CD     │→  │  App       │
│            │   │  Store     │   │  Pipeline  │   │  Runtime   │
└────────────┘   └────────────┘   └────────────┘   └────────────┘
                  ↑
                  │ (রোটেশন/অডিট)
                  └──────────────────────┘
```

## Production টিপস
- .env ফাইল 600 পারমিশন
- গিটে কখনোই সিক্রেট না রাখুন
- Vault/SOPS ব্যবহার করলে কী রোটেট ও অ্যাক্সেস মনিটর করুন
- CI/CD-তে সিক্রেট inject করুন, হার্ডকোড নয়
- কনটেইনারে ENV leak হয় কিনা চেক করুন: `docker inspect`
- ক্লাউড সিক্রেট ম্যানেজারে অটো-রোটেশন সেট করুন (যেমন RDS পাসওয়ার্ড)
- MFA/লিস্ট প্রিন্সিপাল অ্যাক্সেস ব্যবহার করুন
- সিক্রেট স্ক্যানিং টুল (যেমন TruffleHog) গিট হুক-এ যোগ করুন

## সাধারণ সমস্যা ও সমাধান
| সমস্যা | কারণ | সমাধান |
|--------|------|--------|
| সিক্রেট গিটে চলে গেছে | .gitignore নেই | গিট হিস্ট্রি থেকে রিমুভ করুন (git filter-branch বা BFG Repo-Cleaner) |
| ENV leak | কনটেইনার inspect | ENV কমান, bind-mount করুন বা external secret operator ব্যবহার করুন |
| Vault access fail | টোকেন/ACL ভুল | টোকেন/পলিসি চেক, অডিট লগ দেখুন |
| রোটেশন ফেল | অটো-স্ক্রিপ্ট ভুল | টেস্ট রান করুন, অ্যালার্ট সেট করুন |
| ক্লাউড কস্ট | অ্যাক্সেস অনেক | অপটিমাইজ IAM, অডিট লগ মনিটর করুন |

## চেকলিস্ট
- [ ] .env গিটে নেই
- [ ] পারমিশন 600
- [ ] Vault/SOPS/K8s সিক্রেট কনফিগ
- [ ] CI/CD-তে inject
- [ ] রোটেশন/মনিটরিং
- [ ] সিক্রেট স্ক্যানিং টুল সেটআপ
- [ ] অ্যাক্সেস লগ অডিট
- [ ] ব্যাকআপ/রিকভারি প্ল্যান

## অ্যাডভান্সড টপিকস
### সার্ভারলেস এনভায়রনমেন্টে সিক্রেট
Lambda বা Cloud Functions-এ সিক্রেট ENV-এ সেট করুন বা সিক্রেট ম্যানেজার থেকে ফেচ করুন। উদাহরণ (AWS Lambda Python):
```python
import boto3
client = boto3.client('secretsmanager')
response = client.get_secret_value(SecretId='mysecret')
secret = response['SecretString']
```

### সিক্রেট ইনজেকশন টুল
- External Secrets Operator (Kubernetes): AWS/GCP/Vault থেকে K8s Secrets-এ সিঙ্ক করুন।
- Sealed Secrets: Kubernetes-এ এনক্রিপ্টেড YAML গিটে রাখুন।

### অডিটিং এবং কমপ্লায়েন্স
Vault-এ অডিট লগ এনাবল করুন:
```bash
vault audit enable file file_path=/vault/logs/audit.log
```
ক্লাউড প্রোভাইডারে CloudTrail বা Audit Logs চালু রাখুন। GDPR/HIPAA-এর জন্য অ্যাক্সেস হিস্ট্রি ট্র্যাক করুন।

## পরবর্তী
জিরো ডাউনটাইম ডেপ্লয়: strategy, healthcheck, rollback → [/self-hosting/zero-downtime-deploy](/self-hosting/zero-downtime-deploy)

<Callout type="info">সিক্রেট leak হলে দ্রুত রিভোক/রোটেট করুন, মনিটরিং চালু রাখুন।</Callout>

<Callout type="success">এখন আপনি production-grade সিক্রেট ম্যানেজমেন্ট confidently করতে পারবেন!</Callout>

<Callout type="warning">সবসময় least privilege প্রিন্সিপাল ফলো করুন—শুধু যা দরকার তাই অ্যাক্সেস দিন।</Callout>