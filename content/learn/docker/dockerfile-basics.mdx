---
title: "ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржмрзЗрж╕рж┐ржХ ржУ ржирж┐рж░рзНржжрзЗрж╢ржирж╛"
icon: uim:docker
---

### рзз. Dockerfile ржХрзА?

**ржбржХрж╛рж░ржлрж╛ржЗрж▓** рж╣рж▓рзЛ ржПржХржЯрж┐ ржЯрзЗржХрзНрж╕ржЯ ржлрж╛ржЗрж▓ ржпрзЗржЦрж╛ржирзЗ ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ рж▓рзЗржЦрж╛ ржерж╛ржХрзЗтАФржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзЗрж░ ржкрж░рж┐ржмрзЗрж╢ ржХрж┐ржнрж╛ржмрзЗ рждрзИрж░рж┐ рж╣ржмрзЗ, ржХрзЛржи ржХрзЛржи ржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ рж▓рж╛ржЧржмрзЗ, ржПржмржВ ржХржиржЯрзЗржЗржирж╛рж░ ржЪрж╛рж▓рзБ рж╣рж▓рзЗ ржХрзАржнрж╛ржмрзЗ ржЪрж▓ржмрзЗред

**ржХрзЗржи ржжрж░ржХрж╛рж░?**
- ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржЫрж╛рзЬрж╛ ржХржиржЯрзЗржЗржирж╛рж░ ржкрж░рж┐ржмрзЗрж╢ ржорзНржпрж╛ржирзБрзЯрж╛рж▓рж┐ рждрзИрж░рж┐ ржХрж░рждрзЗ рж╣рзЯтАФржпрж╛ рж╕ржорзЯрж╕рж╛ржкрзЗржХрзНрж╖, ржнрзБрж▓рзЗрж░ рж╕ржорзНржнрж╛ржмржирж╛ ржмрзЗрж╢рж┐ред
- ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржжрж┐рзЯрзЗ ржкрж░рж┐ржмрзЗрж╢ ржмрж╛рж░ржмрж╛рж░ ржПржХржЗржнрж╛ржмрзЗ рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛рзЯтАФржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯ, ржЯрзЗрж╕рзНржЯ, ржкрзНрж░рзЛржбрж╛ржХрж╢ржи рж╕ржм ржЬрж╛рзЯржЧрж╛рзЯ ржПржХрж░ржХржо ржерж╛ржХрзЗред
- ржнрж╛рж░рзНрж╕ржи ржХржирзНржЯрзНрж░рзЛрж▓рзЗ ржбржХрж╛рж░ржлрж╛ржЗрж▓ рж░рж╛ржЦрж▓рзЗ, ржХрзЗ ржХржЦржи ржХрзА ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗржЫрзЗ рж╕рж╣ржЬрзЗ ржжрзЗржЦрж╛ ржпрж╛рзЯред
- ржЕржЯрзЛржорзЗрж╢ржи ржкрж╛ржЗржкрж▓рж╛ржЗржирзЗ (CI/CD) ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржмрж┐рж▓рзНржб/ржЯрзЗрж╕рзНржЯ/ржбрж┐ржкрзНрж▓рзЯ ржЕржЯрзЛ рж╣рзЯрзЗ ржпрж╛рзЯред

**ржмрж╛рж╕рзНрждржм ржЙржжрж╛рж╣рж░ржг:**
ржпрзЗржоржи рж░рж╛ржирзНржирж╛рж░ рж░рзЗрж╕рж┐ржкрж┐тАФржПржХржмрж╛рж░ рж▓рж┐ржЦрзЗ рж░рж╛ржЦрж▓рзЗ, ржмрж╛рж░ржмрж╛рж░ ржПржХржЗржнрж╛ржмрзЗ рж░рж╛ржирзНржирж╛ ржХрж░рж╛ ржпрж╛рзЯ; ржирждрзБржи ржХрзЗржЙржУ рж╕рж╣ржЬрзЗ ржмрзБржЭрждрзЗ ржкрж╛рж░рзЗред



## рзи. Dockerfile-ржПрж░ рж╕ржм ржЕржлрж┐рж╕рж┐ржпрж╝рж╛рж▓ ржирж┐рж░рзНржжрзЗрж╢ржирж╛ (Instructions)

ржирж┐ржЪрзЗ ржбржХрж╛рж░ржлрж╛ржЗрж▓рзЗ ржмрзНржпржмрж╣рзГржд рж╕ржм ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржПржмржВ ржЕржлрж┐рж╕рж┐ржпрж╝рж╛рж▓рж┐ рж╕ржорж░рзНржерж┐ржд ржирж┐рж░рзНржжрзЗрж╢ржирж╛рж░ рждрж╛рж▓рж┐ржХрж╛, ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржмрзНржпрж╛ржЦрзНржпрж╛, ржмрзНржпржмрж╣рж╛рж░рж┐ржХ ржЯрж┐ржкрж╕ ржУ ржЙржжрж╛рж╣рж░ржгрж╕рж╣:

### рзз. FROM
ржмрзЗрж╕ ржЗржорзЗржЬ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗтАФржЖржкржирж╛рж░ ржХржиржЯрзЗржЗржирж╛рж░ ржХрзЛржи ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо ржмрж╛ ржкрж░рж┐ржмрзЗрж╢ ржерзЗржХрзЗ рж╢рзБрж░рзБ рж╣ржмрзЗред
**ржмрзНржпржмрж╣рж╛рж░:** рж╕ржм ржбржХрж╛рж░ржлрж╛ржЗрж▓рзЗ ржкрзНрж░ржержорзЗржЗ FROM ржерж╛ржХрждрзЗ рж╣ржмрзЗред
**ржЯрж┐ржк:** рж╕ржмрж╕ржорзЯ ржЕржлрж┐рж╕рж┐ржпрж╝рж╛рж▓ ржмрж╛ ржмрж┐рж╢рзНржмрж╕рзНржд ржЗржорзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред
**ржнрзБрж▓:** ржнрзБрж▓ ржмрзЗрж╕ ржЗржорзЗржЬ ржирж┐рж▓рзЗ ржХржорзНржкрзНржпрж╛ржЯрж┐ржмрж┐рж▓рж┐ржЯрж┐/рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ рж╕ржорж╕рзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗред
```dockerfile
FROM ubuntu:22.04
```

### рзи. RUN
ржмрж┐рж▓рзНржб ржЯрж╛ржЗржорзЗ рж╢рзЗрж▓ ржХржорж╛ржирзНржб ржЪрж╛рж▓рж╛рзЯтАФржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ ржЗржирж╕рзНржЯрж▓, ржмрж┐рж▓рзНржб, ржХржиржлрж┐ржЧ ржкрж░рж┐ржмрж░рзНрждржи ржЗрждрзНржпрж╛ржжрж┐ред
**ржмрзНржпржмрж╣рж╛рж░:** ржкрзНрж░рждрж┐ржЯрж┐ RUN ржХржорж╛ржирзНржб ржПржХржЯрж┐ ржирждрзБржи рж▓рзЗржпрж╝рж╛рж░ рждрзИрж░рж┐ ржХрж░рзЗред
**ржЯрж┐ржк:** ржПржХрж╛ржзрж┐ржХ ржХржорж╛ржирзНржб ржПржХрж╕рж╛ржерзЗ рж▓рж┐ржЦрж▓рзЗ ржХржо рж▓рзЗржпрж╝рж╛рж░ рж╣рзЯ (ржпрзЗржоржи: `RUN apt-get update && apt-get install -y curl`)ред
**ржнрзБрж▓:** ржЯрзЗржорзНржк/ржХрзНржпрж╛рж╢ ржлрж╛ржЗрж▓ ржмрж┐рж▓рзНржб рж╢рзЗрж╖рзЗ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржирж╛ ржХрж░рж▓рзЗ ржЗржорзЗржЬ ржмрзЬ рж╣рзЯред
```dockerfile
RUN apt-get update && apt-get install -y curl
```

### рзй. CMD
ржХржиржЯрзЗржЗржирж╛рж░ ржЪрж╛рж▓рзБ рж╣рж▓рзЗ ржбрж┐ржлрж▓рзНржЯ ржХржорж╛ржирзНржб рж╣рж┐рж╕рзЗржмрзЗ ржЪрж▓рзЗред
**ржмрзНржпржмрж╣рж╛рж░:** `docker run`-ржП ржХржорж╛ржирзНржб ржжрж┐рж▓рзЗ override ржХрж░рж╛ ржпрж╛рзЯред
**ржЯрж┐ржк:** ржПржХрж╛ржзрж┐ржХ ржХржорж╛ржирзНржб ржерж╛ржХрж▓рзЗ ENTRYPOINT ржУ CMD ржПржХрж╕рж╛ржерзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред
**ржнрзБрж▓:** CMD ржнрзБрж▓ рж╣рж▓рзЗ ржХржиржЯрзЗржЗржирж╛рж░ ржмржирзНржз рж╣рзЯрзЗ ржпрж╛рзЯред
```dockerfile
CMD ["python3", "app.py"]
```

### рзк. LABEL
ржЗржорзЗржЬрзЗрж░ ржорзЗржЯрж╛ржбрж╛ржЯрж╛ (рж░ржХрзНрж╖ржгрж╛ржмрзЗржХрзНрж╖ржгржХрж╛рж░рзА, ржнрж╛рж░рзНрж╕ржи, ржмрж┐ржмрж░ржг) ржпрзЛржЧ ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред
**ржмрзНржпржмрж╣рж╛рж░:** ржЕржЯрзЛржорзЗрж╢ржи, ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ, ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж╕рзНржХрзНржпрж╛ржи ржЗрждрзНржпрж╛ржжрж┐рждрзЗ ржХрж╛ржЬрзЗ рж▓рж╛ржЧрзЗред
**ржЯрж┐ржк:** ржкрзНрж░ржЬрзЗржХрзНржЯ рждржерзНржп, maintainer, version рж╕ржмрж╕ржорзЯ label ржХрж░рзБржиред
```dockerfile
LABEL maintainer="webx@example.com"
```

### рзл. EXPOSE
ржХржиржЯрзЗржЗржирж╛рж░рзЗрж░ ржХрзЛржи ржкрзЛрж░рзНржЯ ржЦрзЛрж▓рж╛ ржерж╛ржХржмрзЗ рждрж╛ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи рж╣рж┐рж╕рзЗржмрзЗ ржжрзЗрзЯред
**ржмрзНржпржмрж╣рж╛рж░:** ржЕрзНржпрж╛ржк/рж╕рж╛рж░рзНржнрж┐рж╕ ржХрзЛржи ржкрзЛрж░рзНржЯрзЗ ржЪрж▓рзЗ рждрж╛ ржШрзЛрж╖ржгрж╛ ржХрж░рж╛ред
**ржЯрж┐ржк:** EXPOSE рж╢рзБржзрзБ ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи, ржЖрж╕рж▓ ржкрзЛрж░рзНржЯ ржмрж╛ржЗржирзНржбрж┐ржВ `docker run -p` ржжрж┐рзЯрзЗ рж╣рзЯред
```dockerfile
EXPOSE 8080
```

### рзм. ENV
ржПржиржнрж╛ржпрж╝рж░ржиржорзЗржирзНржЯ ржнрзНржпрж╛рж░рж┐ржпрж╝рзЗржмрж▓ рж╕рзЗржЯ ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯтАФржХржиржлрж┐ржЧ, ржкрж╛рже, рж╕рж┐ржХрзНрж░рзЗржЯ ржЗрждрзНржпрж╛ржжрж┐ред
**ржмрзНржпржмрж╣рж╛рж░:** ржмрж┐рж▓рзНржб ржЯрж╛ржЗржо ржУ рж░рж╛ржиржЯрж╛ржЗржорзЗ ржнрзНржпрж╛рж░рж┐ржпрж╝рзЗржмрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯред
**ржЯрж┐ржк:** рж╕ржВржмрзЗржжржирж╢рзАрж▓ рждржерзНржп (ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб) ENV-ржП ржирж╛ рж░рж╛ржЦрж╛ржЗ ржнрж╛рж▓рзЛ; рж╕рж┐ржХрзНрж░рзЗржЯ vault ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред
```dockerfile
ENV APP_HOME=/app
```

### рзн. ADD
ржлрж╛ржЗрж▓/ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ ржХржкрж┐ ржХрж░рзЗ, `.tar` ржлрж╛ржЗрж▓ ржЕржЯрзЛ-ржПржХрзНрж╕ржЯрзНрж░рж╛ржХрзНржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗ, рж░рж┐ржорзЛржЯ URL ржерзЗржХрзЗржУ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рждрзЗ ржкрж╛рж░рзЗред
**ржмрзНржпржмрж╣рж╛рж░:** ржЖрж░рзНржХрж╛ржЗржн extract ржмрж╛ рж░рж┐ржорзЛржЯ fetch ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ ADD ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред
**ржЯрж┐ржк:** рж╕рж╛ржзрж╛рж░ржг ржХржкрж┐-рж░ ржЬржирзНржп COPY ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржитАФADD ржмрзЗрж╢рж┐ privilege ржжрзЗрзЯ, ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржЭрзБржБржХрж┐ рж╣рждрзЗ ржкрж╛рж░рзЗред
```dockerfile
ADD app.tar.gz /app
```

### рзо. COPY
ржлрж╛ржЗрж▓/ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ ржХржкрж┐ ржХрж░рзЗтАФADD-ржПрж░ рждрзБрж▓ржирж╛рзЯ рж╕рж╣ржЬ ржУ ржирж┐рж░рж╛ржкржжред
**ржмрзНржпржмрж╣рж╛рж░:** рж╕рзЛрж░рзНрж╕ ржХрзЛржб, ржХржиржлрж┐ржЧ, ржЕрзНржпрж╛рж╕рзЗржЯ ржХржкрж┐ ржХрж░рждрзЗред
**ржЯрж┐ржк:** `.dockerignore` ржжрж┐рзЯрзЗ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ ржмрж╛ржж ржжрж┐ржиред
```dockerfile
COPY . /app
```

### рзп. ENTRYPOINT
CMD-ржПрж░ ржорждрзЛ, ржХрж┐ржирзНрждрзБ ржХржиржЯрзЗржЗржирж╛рж░рзЗрж░ ржорзВрж▓ executable рж╣рж┐рж╕рзЗржмрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯтАФoverride ржХрж░рж╛ ржХржарж┐ржиред
**ржмрзНржпржмрж╣рж╛рж░:** рж╢рзЗрж▓ рж╕рзНржХрзНрж░рж┐ржкрзНржЯ, ржЕрзНржпрж╛ржк ржмрж╛ржЗржирж╛рж░рж┐, рж╕рж╛рж░рзНржнрж╛рж░ ржкрзНрж░рж╕рзЗрж╕ ржЪрж╛рж▓рж╛рждрзЗред
**ржЯрж┐ржк:** ENTRYPOINT + CMD ржПржХрж╕рж╛ржерзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ flexible override ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯред
```dockerfile
ENTRYPOINT ["python3", "app.py"]
```

### рззрзж. VOLUME
ржХржиржЯрзЗржЗржирж╛рж░рзЗ рж╕рзНржерж╛ржпрж╝рзА рж╕рзНржЯрзЛрж░рзЗржЬрзЗрж░ ржЬржирзНржп ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рзЗтАФhost ржмрж╛ ржЕржирзНржп ржХржиржЯрзЗржЗржирж╛рж░рзЗ data save рж╣рзЯред
**ржмрзНржпржмрж╣рж╛рж░:** ржбрж╛ржЯрж╛ржмрзЗрж╕, ржЖржкрж▓рзЛржб, рж▓ржЧ ржЗрждрзНржпрж╛ржжрж┐ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗред
**ржЯрж┐ржк:** VOLUME ржШрзЛрж╖ржгрж╛ ржХрж░рж▓рзЗ data loss ржХржорзЗ, ржЖржкржЧрзНрж░рзЗржб рж╕рж╣ржЬ рж╣рзЯред
```dockerfile
VOLUME /data
```

### рззрзз. USER
ржХржиржЯрзЗржЗржирж╛рж░рзЗ ржХрзЛржи ржЗржЙржЬрж╛рж░ рж╣рж┐рж╕рзЗржмрзЗ ржХржорж╛ржирзНржб ржЪрж▓ржмрзЗ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗтАФржирж┐рж░рж╛ржкрждрзНрждрж╛рж░ ржЬржирзНржп ржнрж╛рж▓рзЛред
**ржмрзНржпржмрж╣рж╛рж░:** root ржЫрж╛рзЬрж╛ ржЕржирзНржп user ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи (ржпрзЗржоржи: `USER appuser`)ред
**ржЯрж┐ржк:** ржкрзНрж░рзЛржбрж╛ржХрж╢ржирзЗ root user ржПрзЬрж┐рзЯрзЗ ржЪрж▓рзБржиред
```dockerfile
USER webx
```

### рззрзи. WORKDIR
ржХржиржЯрзЗржЗржирж╛рж░рзЗ ржХрж╛ржЬ ржХрж░рж╛рж░ ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ рж╕рзЗржЯ ржХрж░рзЗтАФржкрж░ржмрж░рзНрждрзА ржХржорж╛ржирзНржб ржПржЗ path-ржП ржЪрж▓ржмрзЗред
**ржмрзНржпржмрж╣рж╛рж░:** рж╕рзЛрж░рзНрж╕ ржХрзЛржб, ржмрж┐рж▓рзНржб, рж░рж╛ржи рж╕ржм ржирж┐рж░рзНржжрж┐рж╖рзНржЯ path-ржП ржХрж░рждрзЗред
**ржЯрж┐ржк:** WORKDIR ржирж╛ ржжрж┐рж▓рзЗ ржбрж┐ржлрж▓рзНржЯ `/` рж╣рзЯ, path mismatch рж╣рждрзЗ ржкрж╛рж░рзЗред
```dockerfile
WORKDIR /app
```

### рззрзй. ARG
ржмрж┐рж▓рзНржб ржЯрж╛ржЗржо ржЖрж░рзНржЧрзБржорзЗржирзНржЯ, ржпрж╛ ржЗржорзЗржЬ рждрзИрж░рж┐рж░ рж╕ржорзЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯтАФрж░рж╛ржиржЯрж╛ржЗржорзЗ access ржХрж░рж╛ ржпрж╛рзЯ ржирж╛ред
**ржмрзНржпржмрж╣рж╛рж░:** ржнрж╛рж░рзНрж╕ржи, ржмрж┐рж▓рзНржб ржлрзНрж▓рзНржпрж╛ржЧ, рж╕рж┐ржХрзНрж░рзЗржЯ ржмрж┐рж▓рзНржб ржЯрж╛ржЗржорзЗ ржкрж╛ржарж╛рждрзЗред
**ржЯрж┐ржк:** ARG рж╢рзБржзрзБ ржмрж┐рж▓рзНржб ржЯрж╛ржЗржорзЗ, ENV рж░рж╛ржиржЯрж╛ржЗржорзЗред
```dockerfile
ARG VERSION=1.0
```

### рззрзк. ONBUILD
parent image рждрзИрж░рж┐ рж╣рж▓рзЗ ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░рж╛ рж╣ржмрзЗ ржПржоржи ржХржорж╛ржирзНржб ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗтАФchild image build-ржП execute рж╣рзЯред
**ржмрзНржпржмрж╣рж╛рж░:** ржЯрзЗржоржкрзНрж▓рзЗржЯ/base image ржмрж╛ржирж╛рждрзЗред
**ржЯрж┐ржк:** ONBUILD ржкрзНрж░рзЛржбрж╛ржХрж╢ржи ржЗржорзЗржЬрзЗ ржПрзЬрж┐рзЯрзЗ ржЪрж▓рзБржитАФржЕржирж╛ржХрж╛ржЩрзНржХрзНрж╖рж┐ржд trigger рж╣рждрзЗ ржкрж╛рж░рзЗред
```dockerfile
ONBUILD COPY . /app
```

### рззрзл. STOPSIGNAL
ржХржиржЯрзЗржЗржирж╛рж░рзЗ termination signal ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗтАФshutdown/control рж╕рж╣ржЬ рж╣рзЯред
**ржмрзНржпржмрж╣рж╛рж░:** ржЧрзНрж░рзЗрж╕ржлрзБрж▓ shutdown, ржХрж╛рж╕рзНржЯржо signal handle ржХрж░рждрзЗред
**ржЯрж┐ржк:** ржбрж┐ржлрж▓рзНржЯ SIGTERM, ржжрж░ржХрж╛рж░ рж╣рж▓рзЗ override ржХрж░рзБржиред
```dockerfile
STOPSIGNAL SIGTERM
```

### рззрзм. HEALTHCHECK
ржХржиржЯрзЗржЗржирж╛рж░рзЗрж░ health/status ржоржирж┐ржЯрж░рж┐ржВ ржХрж░рж╛рж░ ржЬржирзНржптАФservice/app ржарж┐ржХ ржЖржЫрзЗ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзЗред
**ржмрзНржпржмрж╣рж╛рж░:** ржирж┐ржпрж╝ржорж┐ржд ржЪрзЗржХ, restart policy, alert trigger ржХрж░рждрзЗред
**ржЯрж┐ржк:** HEALTHCHECK ржирж╛ ржжрж┐рж▓рзЗ container unhealthy рж╣рж▓рзЗржУ detect рж╣рзЯ ржирж╛ред
```dockerfile
HEALTHCHECK --interval=30s CMD curl -f http://localhost:8080/ || exit 1
```

### рззрзн. SHELL
ржХрзЛржи shell ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ RUN, CMD, ENTRYPOINT ржЪрж╛рж▓рж╛ржирзЛ рж╣ржмрзЗ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рзЗтАФржбрж┐ржлрж▓рзНржЯ `/bin/sh` (Linux), override ржХрж░рж╛ ржпрж╛рзЯред
**ржмрзНржпржмрж╣рж╛рж░:** Windows ржХржиржЯрзЗржЗржирж╛рж░рзЗ PowerShell, Linux-ржП bash/shред
**ржЯрж┐ржк:** shell syntax mismatch рж╣рж▓рзЗ build/run error рж╣рждрзЗ ржкрж╛рж░рзЗред
```dockerfile
SHELL ["powershell", "-command"]
```
ЁЯТб **ржЯрж┐ржкрж╕:**
- рж╕ржм ржирж┐рж░рзНржжрзЗрж╢ржирж╛ ржмрзЬ рж╣рж╛рждрзЗрж░ ржмрж╛ ржЫрзЛржЯ рж╣рж╛рждрзЗрж░ ржЕржХрзНрж╖рж░рзЗ рж▓рзЗржЦрж╛ ржпрж╛рзЯред
- ржкрзНрж░рждрзНржпрзЗржХржЯрж┐ ржирж┐рж░рзНржжрзЗрж╢ржирж╛ ржПржХржЯрж┐ ржирждрзБржи **рж▓рзЗржпрж╝рж╛рж░** рждрзИрж░рж┐ ржХрж░рзЗ (RUN, COPY, ADD)ред
- ржЕржирзБржкрж╕рзНржерж┐ржд ржирж┐рж░рзНржжрзЗрж╢ржирж╛ (ржпрзЗржоржи CMD) рж╣рж▓рзЗ, ржбрж┐ржлрж▓рзНржЯ shell ржмрзНржпржмрж╣рзГржд рж╣ржпрж╝ред

---

ржЪрж▓рзБржи ржПржХржЯрж┐ **рж╕ржорзНржкрзВрж░рзНржг ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржЙржжрж╛рж╣рж░ржг** ржжрзЗржЦрж┐, ржпрзЗржЦрж╛ржирзЗ ржкрзНрж░рж╛ржпрж╝ рж╕ржм ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржирж┐рж░рзНржжрзЗрж╢ржирж╛ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред ржПржЦрж╛ржирзЗ **Python Flask ржЕрзНржпрж╛ржк** ржПрж░ ржЙржжрж╛рж╣рж░ржг ржжрзЗржпрж╝рж╛ рж╣ржпрж╝рзЗржЫрзЗ, ржпрж╛ рж╕рж╣ржЬрзЗ ржЪрж╛рж▓рж╛ржирзЛ ржпрж╛ржпрж╝ ржПржмржВ рж╕ржм ржХржорж╛ржирзНржб ржмрзНржпржмрж╣рж╛рж░рж┐ржХржнрж╛ржмрзЗ ржжрзЗржЦрж╛ржирзЛ рж╣ржпрж╝рзЗржЫрзЗред ЁЯЪА

---

```dockerfile title="Dockerfile"
# ----------------------------
# 1. Base Image
# ----------------------------
FROM python:3.12-slim

# ----------------------------
# 2. Metadata
# ----------------------------
LABEL maintainer="webx@example.com"
LABEL version="1.0"
LABEL description="A sample Flask app with complete Dockerfile instructions"

# ----------------------------
# 3. Build Arguments
# ----------------------------
ARG APP_VERSION=1.0

# ----------------------------
# 4. Environment Variables
# ----------------------------
ENV APP_HOME=/app
ENV FLASK_ENV=production
ENV PYTHONUNBUFFERED=1

# ----------------------------
# 5. Working Directory
# ----------------------------
WORKDIR $APP_HOME

# ----------------------------
# 6. Copy Application Files
# ----------------------------
COPY requirements.txt ./
COPY app.py ./

# ----------------------------
# 7. Install Dependencies
# ----------------------------
RUN pip install --no-cache-dir -r requirements.txt

# ----------------------------
# 8. Expose Port
# ----------------------------
EXPOSE 5000

# ----------------------------
# 9. Volume (Optional for persistent data)
# ----------------------------
VOLUME ["/app/data"]

# ----------------------------
# 10. User (Optional for security)
# ----------------------------
RUN useradd -ms /bin/bash webx
USER webx

# ----------------------------
# 11. Healthcheck
# ----------------------------
HEALTHCHECK --interval=30s --timeout=5s \
  CMD curl -f http://localhost:5000/ || exit 1

# ----------------------------
# 12. Entry Point
# ----------------------------
ENTRYPOINT ["python3", "app.py"]

# ----------------------------
# 13. Default Command (can be overridden)
# ----------------------------
CMD ["--port", "5000"]

# ----------------------------
# 14. Stop Signal
# ----------------------------
STOPSIGNAL SIGTERM

# ----------------------------
# 15. Shell (Optional if custom shell needed)
# ----------------------------
SHELL ["/bin/bash", "-c"]
```

---


### тЪб ржмрзНржпрж╛ржЦрзНржпрж╛:

рзз. **FROM**: Python slim ржЗржорзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред
рзи. **LABEL**: ржЗржорзЗржЬрзЗрж░ ржорзЗржЯрж╛ржбрж╛ржЯрж╛ ржжрзЗржпрж╝ред
рзй. **ARG**: ржмрж┐рж▓рзНржб ржЯрж╛ржЗржо ржнрзНржпрж╛рж░рж┐ржпрж╝рзЗржмрж▓ред
рзк. **ENV**: ржХржиржЯрзЗржЗржирж╛рж░-рж▓рзЗржнрзЗрж▓ environment variableред
рзл. **WORKDIR**: ржХрж╛ржЬ ржХрж░рж╛рж░ ржбрж┐рж░рзЗржХрзНржЯрж░рж┐ред
рзм. **COPY**: рж▓рзЛржХрж╛рж▓ ржлрж╛ржЗрж▓ ржХржиржЯрзЗржЗржирж╛рж░рзЗ ржХржкрж┐ред
рзн. **RUN**: ржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ ржЗржирж╕рзНржЯрж▓ред
рзо. **EXPOSE**: Flask ржЕрзНржпрж╛ржкрзЗрж░ ржкрзЛрж░рзНржЯред
рзп. **VOLUME**: рж╕рзНржерж╛ржпрж╝рзА ржбрзЗржЯрж╛ pathред
рззрзж. **USER**: non-root user ржмрзНржпржмрж╣рж╛рж░ред
рззрзз. **HEALTHCHECK**: ржХржиржЯрзЗржЗржирж╛рж░ health monitorред
рззрзи. **ENTRYPOINT + CMD**: ржХржиржЯрзЗржЗржирж╛рж░ ржЪрж╛рж▓рзБрж░ ржХржорж╛ржирзНржбред
рззрзй. **STOPSIGNAL**: ржЧрзНрж░рзЗрж╕ржлрзБрж▓ shutdownред
рззрзк. **SHELL**: ржХрж╛рж╕рзНржЯржо shell ржжрж░ржХрж╛рж░ рж╣рж▓рзЗред



### рзй. ржУрзЯрж╛рж░рзНржХржлрзНрж▓рзЛ

рзз. ржбржХрж╛рж░ржлрж╛ржЗрж▓ рждрзИрж░рж┐ ржХрж░рзБржитАФржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржкрж░рж┐ржмрзЗрж╢ ржУ ржЕрзНржпрж╛ржк рж╕рзЗржЯржЖржк рж▓рж┐ржЦрзБржиред
рзи. ржмрж┐рж▓рзНржб ржХрж░рзБржи: `docker build -t myapp .`
рзй. ржХржиржЯрзЗржЗржирж╛рж░ ржЪрж╛рж▓рж╛ржи: `docker run myapp`
рзк. рж╕ржорж╕рзНржпрж╛ рж╣рж▓рзЗ:
	- ржмрж┐рж▓рзНржб рж▓ржЧ ржжрзЗржЦрзБржи (ржПрж░рж░ ржорзЗрж╕рзЗржЬ ржмрзБржЭрждрзЗ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзБржи)
	- ржХржиржЯрзЗржХрзНрж╕ржЯ ржЫрзЛржЯ ржХрж░рзБржи (ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ ржмрж╛ржж ржжрж┐ржи)
	- `.dockerignore` ржЖржкржбрзЗржЯ ржХрж░рзБржи
	- RUN/CMD ржХржорж╛ржирзНржбрзЗ shell syntax ржарж┐ржХ ржЖржЫрзЗ ржХрж┐ржирж╛ ржжрзЗржЦрзБржи




### рзк. ржХрзЗржи ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг?

**ржбржХрж╛рж░ржлрж╛ржЗрж▓** ржжрж┐рзЯрзЗ ржкрж░рж┐ржмрзЗрж╢ ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рж╛ ржпрж╛рзЯ, ржЕржЯрзЛржорзЗрж╢ржи ржкрж╛ржЗржкрж▓рж╛ржЗржирзЗ рж╕ржВржпрзБржХрзНржд ржХрж░рж╛ ржпрж╛рзЯ, ржПржмржВ ржжрзНрж░рзБржд ржУ ржирж┐рж░рж╛ржкржжржнрж╛ржмрзЗ ржбрж┐ржкрзНрж▓рзЯ ржХрж░рж╛ ржпрж╛рзЯред
ржПржЫрж╛рзЬрж╛, ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж╕рзНржХрзНржпрж╛ржи, ржкрзБржирж░рзБрждрзНржкрж╛ржжржиржпрзЛржЧрзНржпрждрж╛, ржПржмржВ rollback рж╕рж╣ржЬ рж╣рзЯред




### рзл. ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗржи?

ржпржЦржи ржирждрзБржи ржЕрзНржпрж╛ржк ржкрзНржпрж╛ржХрзЗржЬ ржХрж░рждрзЗ ржЪрж╛ржи, ржПржХрж╛ржзрж┐ржХ ржкрж░рж┐ржмрзЗрж╢ рж╕рзЗржЯржЖржк ржжрж░ржХрж╛рж░, ржЕржержмрж╛ CI/CD ржкрж╛ржЗржкрж▓рж╛ржЗржирзЗ ржмрж┐рж▓рзНржб/ржЯрзЗрж╕рзНржЯ/ржбрж┐ржкрзНрж▓рзЯ ржЕржЯрзЛржорзЗржЯ ржХрж░рждрзЗ ржЪрж╛ржитАФржбржХрж╛рж░ржлрж╛ржЗрж▓ ржЕржкрж░рж┐рж╣рж╛рж░рзНржпред
ржПржЫрж╛рзЬрж╛, ржкрзБрж░ржирзЛ ржЕрзНржпрж╛ржк ржХржиржЯрзЗржЗржирж╛рж░рж╛ржЗржЬ ржХрж░рждрзЗ, ржмрж╛ ржбрзЗржн/ржкрзНрж░рзЛржб/ржЯрзЗрж╕рзНржЯ ржкрж░рж┐ржмрзЗрж╢ ржЖрж▓рж╛ржжрж╛ ржХрж░рждрзЗ ржЪрж╛ржЗрж▓рзЗ ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржиред




### рзм. рж╕рж╛ржзрж╛рж░ржг ржнрзБрж▓ ржУ рж╕ржорж╛ржзрж╛ржи

**ржнрзБрж▓ ржУ рж╕ржорж╛ржзрж╛ржи:**
- ржЕржкрзНржЯрж┐ржорж╛ржЗржЬржб ржирж╛ рж╣ржУрзЯрж╛ ржбржХрж╛рж░ржлрж╛ржЗрж▓: ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ рж▓рзЗржпрж╝рж╛рж░, ржмрзЬ ржХржиржЯрзЗржХрзНрж╕ржЯ, ржХрзНржпрж╛рж╢ ржорж┐рж╕
	- рж╕ржорж╛ржзрж╛ржи: рж▓рзЗржпрж╝рж╛рж░ ржХржорж╛ржи, `.dockerignore` ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи, ржмрж┐рж▓рзНржб ржХрзНржпрж╛рж╢ ржЕржкрзНржЯрж┐ржорж╛ржЗржЬ ржХрж░рзБржи
- ржнрзБрж▓ ржмрзЗрж╕ ржЗржорзЗржЬ: ржХржорзНржкрзНржпрж╛ржЯрж┐ржмрж┐рж▓рж┐ржЯрж┐ рж╕ржорж╕рзНржпрж╛, ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржЭрзБржБржХрж┐
	- рж╕ржорж╛ржзрж╛ржи: ржЕржлрж┐рж╕рж┐ржпрж╝рж╛рж▓/ржнрзЗрж░рж┐ржлрж╛рзЯрзЗржб ржЗржорзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи, ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж╕рзНржХрзНржпрж╛ржи ржЪрж╛рж▓рж╛ржи
- ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ ржХржкрж┐: ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ ржЗржорзЗржЬрзЗ ржЪрж▓рзЗ ржЖрж╕рзЗ
	- рж╕ржорж╛ржзрж╛ржи: `.dockerignore` ржЖржкржбрзЗржЯ ржХрж░рзБржи, ржХрзЗржмрж▓ ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ ржХржкрж┐ ржХрж░рзБржи




### рзн. рж╕рзЗрж░рж╛ ржЪрж░рзНржЪрж╛

**рж╕рзЗрж░рж╛ ржЪрж░рзНржЪрж╛:**
- ржЕржлрж┐рж╕рж┐ржпрж╝рж╛рж▓ ржмрзЗрж╕ ржЗржорзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи
- рж▓рзЗржпрж╝рж╛рж░ ржХржо рж░рж╛ржЦрзБржитАФржПржХржЗ ржзрж░ржирзЗрж░ ржХржорж╛ржирзНржб ржПржХрж╕рж╛ржерзЗ рж▓рж┐ржЦрзБржи
- ржмрж┐рж▓рзНржб рж╢рзЗрж╖рзЗ temp/cache ржлрж╛ржЗрж▓ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржХрж░рзБржи
- `.dockerignore` ржжрж┐рзЯрзЗ ржЕржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж╛ржЗрж▓ ржмрж╛ржж ржжрж┐ржи
- ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ ржмрж┐рж▓рзНржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржитАФржлрж╛ржЗржирж╛рж▓ ржЗржорзЗржЬ ржЫрзЛржЯ ржУ ржирж┐рж░рж╛ржкржж рж╣ржмрзЗ
- ржбржХрж╛рж░ржлрж╛ржЗрж▓рзЗ ржоржирзНрждржмрзНржп рж▓рж┐ржЦрзБржитАФржкрж░ржмрж░рзНрждрзА ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж╕рж╣ржЬрзЗ ржмрзБржЭрждрзЗ ржкрж╛рж░ржмрзЗ
- Healthcheck, labels, ржПржмржВ version info ржпрзЛржЧ ржХрж░рзБржи




### рзо. ржЗржирзНржбрж╛рж╕рзНржЯрзНрж░рж┐ ржЯрзНрж░рзЗржирзНржб

**ржЗржирзНржбрж╛рж╕рзНржЯрзНрж░рж┐ ржЯрзНрж░рзЗржирзНржб:**
- ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ ржмрж┐рж▓рзНржбтАФржмрж┐рж▓рзНржб ржЯрзБрж▓рж╕ ржУ рж░рж╛ржиржЯрж╛ржЗржо ржЖрж▓рж╛ржжрж╛
- ржЕржЯрзЛржорзЗржЯрзЗржб рж▓рж┐ржирзНржЯрж┐ржВтАФ`hadolint` ржжрж┐рзЯрзЗ ржбржХрж╛рж░ржлрж╛ржЗрж▓ ржЪрзЗржХ ржХрж░рзБржи
- ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж╕рзНржХрзНржпрж╛ржирж┐ржВтАФ`trivy`, `docker scan` ржжрж┐рзЯрзЗ ржжрзБрж░рзНржмрж▓рждрж╛ ржЪрзЗржХ ржХрж░рзБржи
- BuildKitтАФржжрзНрж░рзБржд ржУ ржжржХрзНрж╖ ржмрж┐рж▓рзНржб, ржЙржирзНржиржд ржлрж┐ржЪрж╛рж░
- SBOM (Software Bill of Materials)тАФржЗржорзЗржЬрзЗрж░ ржбрж┐ржкрзЗржирзНржбрзЗржирзНрж╕рж┐ рж▓рж┐рж╕рзНржЯ рждрзИрж░рж┐ ржХрж░рзБржи




## ржЙржжрж╛рж╣рж░ржг ржУ рждрзБрж▓ржирж╛

**ржбржХрж╛рж░ржлрж╛ржЗрж▓**тАФрж░рж╛ржирзНржирж╛рж░ рж░рзЗрж╕рж┐ржкрж┐: ржзрж╛ржкрзЗ ржзрж╛ржкрзЗ ржХрзАржнрж╛ржмрзЗ ржЦрж╛ржмрж╛рж░ (ржЗржорзЗржЬ) рждрзИрж░рж┐ рж╣ржмрзЗ
**FROM**тАФрж░рж╛ржирзНржирж╛рж░ ржЙржкржХрж░ржг (ржмрзЗрж╕ ржЗржорзЗржЬ)
**RUN**тАФрж░рж╛ржирзНржирж╛рж░ ржХрж╛ржЬ (ржЗржирж╕рзНржЯрж▓/ржХржиржлрж┐ржЧрж╛рж░)
**COPY**тАФржЙржкржХрж░ржг ржпрзЛржЧ ржХрж░рж╛ (рж╕рзЛрж░рзНрж╕ ржХрзЛржб/ржлрзЛрж▓рзНржбрж╛рж░)
**CMD**тАФржЦрж╛ржмрж╛рж░ ржкрж░рж┐ржмрзЗрж╢ржи (ржХржиржЯрзЗржЗржирж╛рж░ ржЪрж╛рж▓рзБ рж╣рж▓рзЗ ржХрзА рж╣ржмрзЗ)



## ржжрзНрж░рзБржд рж░рзЗржлрж╛рж░рзЗржирзНрж╕
```dockerfile
FROM node:18
WORKDIR /app
COPY . /app
RUN npm install
CMD ["node", "app.js"]
```

**ржмрж┐рж▓рзНржб:**
```bash
docker build -t myapp .
```
**ржЪрж╛рж▓рж╛ржи:**
```bash
docker run myapp
```



## ржЙржкрж╕ржВрж╣рж╛рж░

ржбржХрж╛рж░ржлрж╛ржЗрж▓тАФржХрж╛рж╕рзНржЯржо ржЗржорзЗржЬ рждрзИрж░рж┐рж░ ржЬржирзНржп ржЕржкрж░рж┐рж╣рж╛рж░рзНржпред FROM, RUN, COPY, CMDтАФржПржЗ ржЪрж╛рж░ржЯрж┐ ржирж┐рж░рзНржжрзЗрж╢ржирж╛ ржнрж╛рж▓рзЛржнрж╛ржмрзЗ ржЬрж╛ржирж▓рзЗ, ржжржХрзНрж╖, ржЫрзЛржЯ, ржПржмржВ ржирж┐рж░рж╛ржкржж ржбрж┐ржкрзНрж▓рзЯржорзЗржирзНржЯ рж╕рж╣ржЬ рж╣ржмрзЗред
ржорж╛рж▓рзНржЯрж┐-рж╕рзНржЯрзЗржЬ ржмрж┐рж▓рзНржб, рж▓рж┐ржирзНржЯрж┐ржВ, ржПржмржВ ржирж┐рж░рж╛ржкрждрзНрждрж╛ рж╕рзНржХрзНржпрж╛ржитАФржПрж╕ржм ржЖржзрзБржирж┐ржХ ржЪрж░рзНржЪрж╛ ржЕржирзБрж╕рж░ржг ржХрж░рж▓рзЗ production-ready ржЗржорзЗржЬ рждрзИрж░рж┐ ржХрж░рж╛ ржпрж╛ржмрзЗред